<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Complete Guide for Seven Bridges API R Client &bull; sevenbridges</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">sevenbridges</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Complete Guide for Seven Bridges API R Client</h1>
            
          </div>

    
    
<div class="contents">
<p><a name="top"></a></p>
<div id="introduction" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#introduction" class="anchor"> </a></body></html>Introduction</h2>
<p>sevenbridges-r is an R/Bioconductor package that provides an interface for the <a href="https://www.sbgenomics.com/">Seven Bridges Platform</a> and <a href="http://www.cancergenomicscloud.org/">Cancer Genomics Cloud (CGC)</a> public APIs.</p>
<p>Learn more from our documentation on the <a href="http://docs.sevenbridges.com/page/api">Seven Bridges Platform</a> and the <a href="http://docs.cancergenomicscloud.org/v1.0/page/the-cgc-api">Cancer Genomics Cloud (CGC)</a>.</p>
<p><strong><em>Note:</em></strong> API paths differ for each Seven Bridges environment. Be sure to provide the correct path for the environment you are using. The paths are as follows:</p>
<ul><li><strong>Cancer Genomics Cloud:</strong> <a href="https://cgc-api.sbgenomics.com/v2/" class="uri">https://cgc-api.sbgenomics.com/v2/</a></li>
<li><strong>Seven Bridges Platform on Amazon Web Services:</strong> <a href="https://api.sbgenomics.com/v2/" class="uri">https://api.sbgenomics.com/v2/</a></li>
<li><strong>Seven Bridges Platform on Google Cloud Platform: </strong><a href="https://gcp-api.sbgenomics.com/v2/" class="uri">https://gcp-api.sbgenomics.com/v2/</a></li>
</ul><div align="right">
<a href="#top">top</a>
</div>
<div id="api-r-client" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#api-r-client" class="anchor"> </a></body></html>API R client</h3>
<p>The <code>sevenbridges</code> package only supports V2+ versions of the API, since versions prior to V2 are not compatible with the Common Workflow Language (CWL). This package provides a simple interface for accessing and trying out various methods.</p>
<p>There are two ways of constructing API calls. For instance, you can use low-level API calls which use arguments like <code>path</code>, <code>query</code>, and <code>body</code>. These are documented in the API reference libraries for the <a href="http://docs.sevenbridges.com/v1.0/docs/list-of-api-calls">Seven Bridges Platform</a> and the <a href="http://docs.cancergenomicscloud.org/docs/new-1">CGC</a>. An example of a low-level request to &ldquo;list all projects&rdquo; is shown below. In this request, you can also pass <code>query</code> and <code>body</code> as a list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sevenbridges)
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">token =</span> <span class="st">"8c3329a4de664c35bb657499bb2f335c"</span>, 
          <span class="dt">url =</span> <span class="st">"https://api.sbgenomics.com/v2/"</span>)
a$<span class="kw"><a href="../reference/api.html">api</a></span>(<span class="dt">path =</span> <span class="st">"project"</span>, <span class="dt">method =</span> <span class="st">"GET"</span>)</code></pre></div>
<p><strong><em>(Advanced user option)</em></strong> The second way of constructing an API request is to directly use the <code>httr</code> package to make your API calls, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">project</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="api-general-information" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#api-general-information" class="anchor"> </a></body></html>API general information</h3>
<p>Before we start, keep in mind the following:</p>
<p><strong><code>offset</code> and <code>limit</code></strong></p>
Every API call accept arguments called <code>offset</code> and <code>limit</code>.
<ul><li>
Offset defines where the retrieved items started.
</li>
<li>
Limit defines the quantity of items you want to get.
</li>
</ul><p>By default, <code>offset</code> is set to <code>0</code> and <code>limit</code> is set to <code>50</code>. As such, your API request returns the <strong>first 100 items</strong> when you list items or search for items by name. To search and list all items, use <code>complete = TRUE</code> in your API request.</p>
<p><strong>Search by ID</strong></p>
<p>When searching by ID, your request will return your exact resource as it is unique. As such, you don&rsquo;t have to manually set <code>offset</code> and <code>limit</code>. It&rsquo;s good practice to find your resources by their ID and pass this ID as an input to your task. You can find a resource&rsquo;s ID in the final part of the URL on the visual interface or via the API requests to list resources or get a resource&rsquo;s details.</p>
<p><strong>Search by name</strong></p>
<p>Search by name returns all partial matches unless you specify <code>exact = TRUE</code>. &nbsp;</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="installation" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#installation" class="anchor"> </a></body></html>Installation</h3>
<p>The <code>sevenbridges</code> package is on both the Bioconductor released and devel branches, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## try http:// if https:// URLs are not supported
<span class="kw">source</span>(<span class="st">"https://bioconductor.org/biocLite.R"</span>)
<span class="kw">biocLite</span>(<span class="st">"sevenbridges"</span>)</code></pre></div>
<p>Since we are constantly improving our API and binding libraries, please also visit our <a href="https://github.com/sbg/sevenbridges-r">github homepage</a> for most recent news and for latest version of the package.</p>
<div align="right">
<a href="#top">top</a>
</div>
<p><strong>If you don&rsquo;t have <code>devtools</code></strong></p>
<p>This installation requires that you have the <code>devtools</code> package. If you do not have this package, you can install it from <a href="https://cran.r-project.org/web/packages/devtools/index.html">CRAN</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"devtools"</span>) </code></pre></div>
<p>You may got an error and need system dependecies for curl and ssl. For example, in ubuntu you probably need to do the following first in order to install <code>devtools</code> and in order to build vignettes since you need <code>pandoc</code>.</p>
<pre><code>apt-get update
apt-get install libcurl4-gnutls-dev libssl-dev pandoc pandoc-citeproc</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
<p><strong>If <code>devtools</code> is already installed</strong></p>
<p>Install the latest version for <code>sevenbridges</code> from GitHub with the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">"http://bioconductor.org/biocLite.R"</span>)
<span class="kw">biocLite</span>(<span class="st">"readr"</span>)

devtools::<span class="kw">install_github</span>(<span class="st">"sbg/sevenbridges-r"</span>, <span class="dt">build_vignettes=</span><span class="ot">TRUE</span>,
  <span class="dt">repos =</span> BiocInstaller::<span class="kw">biocinstallRepos</span>(),
  <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>If you have trouble with <code>pandoc</code> and don&rsquo;t want to install it, set <code>build_vignettes = FALSE</code> to avoid the vignettes build.</p>
</div>
</div>
<div id="quickstart" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#quickstart" class="anchor"> </a></body></html>Quickstart</h2>
<p>For more details about how to use the API client in R, please consult the <a href="#reference">User-friendly API</a> section below for a complete guide. This section is a Quickstart which walks through the basics of using the R cliet libary to help you get started.</p>
<div id="create-auth-object" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#create-auth-object" class="anchor"> </a></body></html>Create Auth object</h3>
<p>Before you can access your account via the API, you have to pass along your credentials. You can obtain your credentials in the form of an <a href="http://docs.sevenbridges.com/v1.0/docs/get-your-authentication-token">authentication token</a> from the <strong>Developer Tab</strong> under <strong>Account Settings</strong> on the visual interface. Once you&rsquo;ve obtained this, let&rsquo;s set up the <code>Auth</code> object so it remembers your authentication token and the path for the API. All subsequent requests will draw upon these two pieces of information.</p>
<p><strong>Step 1: Load the library</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sevenbridges)</code></pre></div>
<p><strong>Step 2: Set up your authentication token</strong></p>
<p>You have three different ways to set up your token. Choose from one of the three methods below:</p>
<ol style="list-style-type: decimal"><li><a href="#method1">Direct setup via <code>Auth</code> function:</a> This explicityly sets up your token and API url.</li>
<li><a href="#method2">Via a configuration file in your home folder:</a> This file, such as &ldquo;.sbg.auth.yml&rdquo;, is very easy to manage and is implicitly loaded everytime you start a new R session.</li>
<li><a href="#method3">Via a temporary setup:</a> This is an option when for each R session.</li>
</ol><div style="margin-left:3em">
<p><a name="method1"></a><strong><em>Method 1: Direct setup</em></strong></p>
<p>This is the most common way to construct your <code>auth</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## direct setup
(a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">token =</span> <span class="st">"&lt;fake_token&gt;"</span>,
          <span class="dt">url =</span> <span class="st">"https://cgc-api.sbgenomics.com/v2/"</span>))
## or load default from config file (autoloaded into options)</code></pre></div>
<pre><code>== Auth ==
token : &lt;fake_token&gt;
url : https://cgc-api.sbgenomics.com/v2/</code></pre>
<p><a name="method2"></a><strong><em>Method 2: Via a configuration file</em></strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## from platfrom "us" for user "tengfei"
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">platform =</span> <span class="st">"us"</span>, <span class="dt">username =</span> <span class="st">"tengfei"</span>)</code></pre></div>
<p><a name="method3"></a><strong><em>Method 3: update the <code>auth</code> object from another config file</em></strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Auth-class.html">updateAuthList</a></span>(<span class="st">"new_config.yml"</span>)</code></pre></div>
</div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-user-information" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#get-user-information" class="anchor"> </a></body></html>Get user information</h3>
<p><a name="youruser"></a><strong>Get your own information</strong></p>
<p>This call returns information about your account.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">user</span>()</code></pre></div>
<pre><code>== User ==
href : https://cgc-api.sbgenomics.com/v2/users/tengfei
username : tengfei
email : tengfei.yin@sbgenomics.com
first_name : Tengfei
last_name : Yin
affiliation : Seven Bridges Genomics
country : United States</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
<p><strong>Get information about a user</strong></p>
<p>This call returns information about the specified user. Note that currently you can view only your own user information, so this call is equivalent to the <a href="#youruser">call to get information about your account</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">user</span>(<span class="dt">username =</span> <span class="st">"tengfei"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="rate-limit" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#rate-limit" class="anchor"> </a></body></html>Rate limit</h3>
<p>This call returns information about your current rate limit. This is the number of API calls you can make in one hour.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">rate_limit</span>()</code></pre></div>
<pre><code>== Rate Limit ==
limit : 1000
remaining : 993
reset : 1457980957</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="show-billing-information" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#show-billing-information" class="anchor"> </a></body></html>Show billing information</h3>
<p>Each project must have a Billing Group associated with it. This Billing Group pays for the storage and computation in the project.</p>
<p>For example, your first project(s) were created with the free funds from the Pilot Funds Billing Group assigned to each user at sign-up. To get information about billing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## check your billing info
a$<span class="kw">billing</span>()
a$<span class="kw">invoice</span>()</code></pre></div>
<p>For more information, use <code>breakdown = TRUE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">billing</span>(<span class="dt">id =</span> <span class="st">"your_billing_id"</span>, <span class="dt">breakdown =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-project" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#create-a-project" class="anchor"> </a></body></html>Create a project</h3>
<p>Projects are the core building blocks of the Platform. Each project corresponds to a distinct scientific investigation, serving as a container for its data, analysis tools, results, and team of collaborators.</p>
<p>Create a new project called &ldquo;api testing&rdquo; with the billing group <code>id</code> obtained above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## get billing group id
bid &lt;-<span class="st"> </span>a$<span class="kw">billing</span>()$id
## create new project
(p &lt;-<span class="st"> </span>a$<span class="kw">project_new</span>(<span class="dt">name =</span> <span class="st">"api testing"</span>, bid, <span class="dt">description =</span> <span class="st">"Just a testing"</span>))</code></pre></div>
<pre><code>== Project ==
id : tengfei/api-testing
name : api testing
description : Just a testing
billing_group_id : &lt;fake_bid&gt;
type : v2
-- Permission --</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-details-about-an-existing-project" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#get-details-about-an-existing-project" class="anchor"> </a></body></html>Get details about an existing project</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## list first 100 
a$<span class="kw">project</span>()
## list all
a$<span class="kw">project</span>(<span class="dt">complete =</span> <span class="ot">TRUE</span>)
## return all named match "demo"
a$<span class="kw">project</span>(<span class="dt">name =</span> <span class="st">"demo"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)
## get the project you want by id
p =<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/api-tutorial"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="copy-a-public-app-into-your-project" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#copy-a-public-app-into-your-project" class="anchor"> </a></body></html>Copy a public app into your project</h3>
<p>Seven Bridges maintains workflows and tools available to all of its users in the Public Apps repository.</p>
<p>To find out more about public apps, you can do the following:</p>
<ul><li>Browse them online. Check out the <a href="http://docs.cancergenomicscloud.org/docs/">tutorial</a> for the &ldquo;Find apps&rdquo; section.</li>
<li>You can use the <code>sevenbridges</code> package to find it, as shown below.</li>
</ul><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## search by name matching, complete = TRUE search all apps, not 
## limited by offset or limit.
a$<span class="kw">public_app</span>(<span class="dt">name =</span> <span class="st">"STAR"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)
## search by id is accurate
a$<span class="kw">public_app</span>(<span class="dt">id =</span> <span class="st">"admin/sbg-public-data/rna-seq-alignment-star/5"</span>)
## you can also get everything 
a$<span class="kw">public_app</span>(<span class="dt">complete =</span> <span class="ot">TRUE</span>)
## default limit = 100, offset = 0 which means first 100
a$<span class="kw">public_app</span>()</code></pre></div>
<p>Now, from your <code>Auth</code> object, you copy an App <code>id</code> into your <code>project</code> id with a new <code>name</code>, following this logic.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## copy
a$<span class="kw">copy_app</span>(<span class="dt">id =</span> <span class="st">"admin/sbg-public-data/rna-seq-alignment-star/5"</span>, 
           <span class="dt">project =</span> <span class="st">"tengfei/api-testing"</span>, <span class="dt">name =</span> <span class="st">"new copy of star"</span>)
## check its' copyed
p =<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/api-testing"</span>)
## list apps your got in your project
p$<span class="kw">app</span>()</code></pre></div>
<p>The short name is changed to <code>newcopyofstar</code>.</p>
<pre><code>== App ==
id : tengfei/api-testing/newcopyofstar/0
name : RNA-seq Alignment - STAR
project : tengfei/api-testing-2
revision : 0</code></pre>
<p>Alternatively, you can copy it from the <code>app</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">app =<span class="st"> </span>a$<span class="kw">public_app</span>(<span class="dt">id =</span> <span class="st">"admin/sbg-public-data/rna-seq-alignment-star"</span>)
app$<span class="kw">copy_to</span>(<span class="dt">project =</span> <span class="st">"tengfei/api-testing"</span>, 
            <span class="dt">name =</span> <span class="st">"copy of star"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="import-cwl-app-and-run-a-task" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#import-cwl-app-and-run-a-task" class="anchor"> </a></body></html>Import CWL app and run a task</h3>
<p>You can also upload your own Common Workflow Language JSON file which describes your app to your project.</p>
<p><strong><em>Note:</em></strong> Alternatively, you can directly describe your CWL tool in R with this package. Please read the vignette on &ldquo;Describe CWL Tools/Workflows in R and Execution&rdquo;.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Add an CWL file to your project
f.star =<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata/app"</span>, <span class="st">"flow_star.json"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
app =<span class="st"> </span>p$<span class="kw">app_add</span>(<span class="st">"starlocal"</span>, fl.runif)
(aid &lt;-<span class="st"> </span>app$id)</code></pre></div>
<p>You&rsquo;ll get an app <code>id</code>, like the one below:</p>
<pre><code>"tengfei/api-testing/starlocal/0"</code></pre>
<p>It&rsquo;s composed of the following elements:</p>
<ol style="list-style-type: decimal"><li><strong>project id</strong> : tengfei/api</li>
<li><strong>app short name</strong> : runif</li>
<li><strong>revision</strong> : 0</li>
</ol><p>Alternatively, you can describe tools in R directly, as shown below:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fl &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"docker"</span>, <span class="st">"sevenbridges/rabix/generator.R"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
<span class="kw">cat</span>(<span class="kw">readLines</span>(fl), <span class="dt">sep =</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</code></pre></div>
<pre><code>library(sevenbridges)
in.lst &lt;- list(input(id = "number",
                     description = "number of observations",
                     type = "integer",
                     label = "number",
                     prefix = "--n",
                     default = 1,
                     required = TRUE, 
                     cmdInclude = TRUE),
               input(id = "min",
                     description = "lower limits of the distribution",
                     type = "float",
                     label = "min",
                     prefix = "--min",
                     default = 0),
               input(id = "max",
                     description = "upper limits of the distribution",
                     type = "float",
                     label = "max",
                     prefix = "--max",
                     default = 1),
               input(id = "seed",
                     description = "seed with set.seed",
                     type = "float",
                     label = "seed",
                     prefix = "--seed",
                     default = 1))


## the same method for outputs
out.lst &lt;- list(output(id = "random",
                       type = "file",
                       label = "output", 
                       description = "random number file",
                       glob = "*.txt"),
                output(id = "report",
                       type = "file",
                       label = "report", 
                       glob = "*.html"))


rbx &lt;- Tool(id = "runif",
            label = "Random number generator",
            hints = requirements(docker(pull = "tengfei/runif"), 
                                 cpu(1), mem(2000)),
            baseCommand = "runif.R",
            inputs = in.lst, ## or ins.df
            outputs = out.lst)


fl &lt;- "inst/docker/sevenbridges/rabix/runif.json"
write(rbx$toJSON(pretty = TRUE), fl)</code></pre>
<p>Then, you can add it like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## rbx is the object returned by Tool function
app =<span class="st"> </span>p$<span class="kw">app_add</span>(<span class="st">"runif"</span>, rbx)
(aid &lt;-<span class="st"> </span>app$id)</code></pre></div>
<p>Please consult another tutorial about how to describe tools and flows in R.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="execute-a-new-task" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#execute-a-new-task" class="anchor"> </a></body></html>Execute a new task</h3>
<div id="find-your-app-inputs" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#find-your-app-inputs" class="anchor"> </a></body></html>Find your app inputs</h4>
<p>Once you have copied the public app <code>admin/sbg-public-data/rna-seq-alignment-star/5</code> into your project, <code>username/api-testing</code>, the app <code>id</code> in your current project is <code>username/api-testing/newcopyofstar</code>. Conversely, you can use another app you already have in your project for this Quickstart.</p>
<p>To draft a new task, you need to specify the following:</p>
<ul><li>The name of the task</li>
<li>An optional description</li>
<li>The app <code>id</code> of the workflow you&rsquo;re executing</li>
<li>The inputs for your workflow. In this case, the CWL app accepts four parameters: number, min, max, and seed.</li>
</ul><p>You can always check the App details on the visual interface for task input requirements. To find the required inputs with R, you need to get an <code>App</code> object first.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">app =<span class="st"> </span>a$<span class="kw">app</span>(<span class="dt">id =</span> <span class="st">"tengfei/api-testing-2/newcopyofstar"</span>)
## get input matrix
app$<span class="kw">input_matrix</span>()
app$<span class="kw">input_matrix</span>(<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"label"</span>, <span class="st">"type"</span>))
app$<span class="kw">input_matrix</span>(<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"label"</span>, <span class="st">"type"</span>), <span class="dt">required =</span> <span class="ot">TRUE</span>)
## get required input names and types only
app$<span class="kw">get_required</span>()</code></pre></div>
<p>Conversely, you can load the app from a CWL JSON and convert it into an R object first, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f1 =<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata/app"</span>, <span class="st">"flow_star.json"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
app =<span class="st"> </span><span class="kw"><a href="../reference/convert_app.html">convert_app</a></span>(f1)
## get input matrix
app$<span class="kw">input_matrix</span>()</code></pre></div>
<pre><code>##                                id                    label    type
## 1                    #sjdbGTFfile              sjdbGTFfile File...
## 2                          #fastq                    fastq File...
## 3               #genomeFastaFiles         genomeFastaFiles    File
## 4 #sjdbGTFtagExonParentTranscript      Exons' parents name  string
## 5       #sjdbGTFtagExonParentGene                Gene name  string
## 6          #winAnchorMultimapNmax         Max loci anchors     int
## 7             #winAnchorDistNbins Max bins between anchors     int
##   required fileTypes
## 1    FALSE      null
## 2     TRUE      null
## 3     TRUE      null
## 4    FALSE      null
## 5    FALSE      null
## 6    FALSE      null
## 7    FALSE      null</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">app$<span class="kw">input_matrix</span>(<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"label"</span>, <span class="st">"type"</span>))</code></pre></div>
<pre><code>##                                id                    label    type
## 1                    #sjdbGTFfile              sjdbGTFfile File...
## 2                          #fastq                    fastq File...
## 3               #genomeFastaFiles         genomeFastaFiles    File
## 4 #sjdbGTFtagExonParentTranscript      Exons' parents name  string
## 5       #sjdbGTFtagExonParentGene                Gene name  string
## 6          #winAnchorMultimapNmax         Max loci anchors     int
## 7             #winAnchorDistNbins Max bins between anchors     int</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">app$<span class="kw">input_matrix</span>(<span class="kw">c</span>(<span class="st">"id"</span>, <span class="st">"label"</span>, <span class="st">"type"</span>), <span class="dt">required =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>##                  id            label    type
## 2            #fastq            fastq File...
## 3 #genomeFastaFiles genomeFastaFiles    File</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## get required input names and types only
app$<span class="kw">get_required</span>()</code></pre></div>
<pre><code>##            fastq genomeFastaFiles 
##        "File..."           "File"</code></pre>
<p>In the response body, locate the names of the required inputs. Note that task inputs need to match the expected data type and name. In the above example, we see two required fields:</p>
<ul><li><strong>fastq:</strong> This input takes a file array as indicated by &ldquo;File&hellip;&rdquo;</li>
<li><strong>genomeFastaFiles:</strong> This is a single file as indicated by &ldquo;File&rdquo;.</li>
</ul><p>We also want to provide a gene feature file:</p>
<ul><li><strong>sjdbGTFfile:</strong> A single file as indicated by &ldquo;File&rdquo;.</li>
</ul><p>You can find a list of possible input types below:</p>
<ul><li><strong>number, character or integer:</strong> you can directly pass these to the input parameter as it is.</li>
<li><strong>enum type:</strong> Pass this value to the input parameter.</li>
<li>**<a href="file:**" class="uri">file:**</a> This input is a file. However, while some inputs accept only single file (&lsquo;File&rsquo;), other inputs takes more than one file (File arrays, FilesList, or &lsquo;File&hellip;&rsquo; ). This input require you to pass a <code>Files</code> object (for a single file input) or <code>FilesList</code> object (for inputs which accept more than one file) or simply a list in a &ldquo;Files&rdquo; object. You can search for your file by <code>id</code> or by <code>name</code> with an exact match (<code>exact = TRUE</code>), as shown in the example below.</li>
</ul><div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-your-input-files-ready" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#get-your-input-files-ready" class="anchor"> </a></body></html>Get your input files ready</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fastqs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"SRR1039508_1.fastq"</span>, <span class="st">"SRR1039508_2.fastq"</span>)

## get all 2 exact files
fastq_in =<span class="st"> </span>p$<span class="kw">file</span>(<span class="dt">name=</span> fastqs, <span class="dt">exact =</span> <span class="ot">TRUE</span>) 

## get single file
fasta_in =<span class="st"> </span>p$<span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"Homo_sapiens.GRCh38.dna.primary_assembly.fa"</span>, 
                  <span class="dt">exact =</span> <span class="ot">TRUE</span>)
## get all single file
gtf_in =<span class="st"> </span>p$<span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"Homo_sapiens.GRCh38.84.gtf"</span>, 
                <span class="dt">exact =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-new-draft-task" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#create-a-new-draft-task" class="anchor"> </a></body></html>Create a new Draft Task</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Add new tasks
taskName =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"tengfei_star-alignment "</span>,<span class="kw">date</span>())

tsk =<span class="st"> </span>p$<span class="kw">task_add</span>(<span class="dt">name =</span> taskName,
           <span class="dt">description =</span> <span class="st">"star test"</span>, 
           <span class="dt">app =</span> <span class="st">"tengfei/api-testing-2/newcopyofstar/0"</span>,
           <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">sjdbGTFfile =</span> gtf_in,
                         <span class="dt">fastq =</span> fastq_in,
                         <span class="dt">genomeFastaFiles =</span> fasta_in))</code></pre></div>
<p>Remember the <code>fastq</code> input expects a list of files. You can also do something as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f1 =<span class="st"> </span>p$<span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"SRR1039508_1.fastq"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
f2 =<span class="st"> </span>p$<span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"SRR1039508_2.fastq"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
## get all 2 exact files
fastq_in =<span class="st"> </span><span class="kw">list</span>(f1, f2) 

## or if you know you only have 2 file name matching SRR924146*.fastq
fastq_in =<span class="st"> </span>p$<span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"SRR1039508*.fastq"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Using <code>complete = TRUE</code> when items is over 100.</p>
</div>
<div id="draft-a-batch-task" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#draft-a-batch-task" class="anchor"> </a></body></html>Draft a batch task</h4>
<p>Now let&rsquo;s do a batch with 8 files in 4 groups, which is batched by metadata <code>sample_id</code> and <code>library_id</code>. We&rsquo;ll assume each file has these two metadata fields entered. Since these files can be evenly grouped into 4, we will have a single parent batch task with 4 child tasks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fastqs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"SRR1039508_1.fastq"</span>, <span class="st">"SRR1039508_2.fastq"</span>, <span class="st">"SRR1039509_1.fastq"</span>, 
            <span class="st">"SRR1039509_2.fastq"</span>, <span class="st">"SRR1039512_1.fastq"</span>, <span class="st">"SRR1039512_2.fastq"</span>, 
            <span class="st">"SRR1039513_1.fastq"</span>, <span class="st">"SRR1039513_2.fastq"</span>)

## get all 8 files
fastq_in =<span class="st"> </span>p$<span class="kw">file</span>(<span class="dt">name=</span> fastqs, <span class="dt">exact =</span> <span class="ot">TRUE</span>) 
## can also try to returned all SRR*.fastq files
## fastq_in = p$file(name= "SRR*.fastq", complete = TRUE) 

tsk =<span class="st"> </span>p$<span class="kw">task_add</span>(<span class="dt">name =</span> taskName,
           <span class="dt">description =</span> <span class="st">"Batch Star Test"</span>, 
           <span class="dt">app =</span> <span class="st">"tengfei/api-testing-2/newcopyofstar/0"</span>,
           <span class="dt">batch =</span> <span class="kw"><a href="../reference/batch.html">batch</a></span>(<span class="dt">input =</span> <span class="st">"fastq"</span>, 
                         <span class="dt">criteria =</span> <span class="kw">c</span>(<span class="st">"metadata.sample_id"</span>,<span class="st">"metadata.noexist_id"</span>)),
           <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">sjdbGTFfile =</span> gtf_in,
                         <span class="dt">fastq =</span> fastqs_in,
                         <span class="dt">genomeFastaFiles =</span> fasta_in))</code></pre></div>
<p>Now you have a draft batch task, please check it out in the visual interface. Your response body should inform you of any errors or warnings.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="run-a-task" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#run-a-task" class="anchor"> </a></body></html>Run a task</h3>
<p>Now, we&rsquo;re ready to run our task.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Run your task
tsk$<span class="kw">run</span>()</code></pre></div>
<p>Before you run your task, you can adjust your draft task if you have any final modifications. Or, you can delete the draft task if you no longer wish to run it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## not run
## tsk$delete()</code></pre></div>
<p>After you run a task, you can abort it</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Abort your task
tsk$<span class="kw">abort</span>()</code></pre></div>
<p>If you want to update your task and then re-run it, follow the example below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsk$<span class="kw">getInputs</span>()
## missing number input, only update number
tsk$<span class="kw">update</span>(<span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">sjdbGTFfile =</span> <span class="st">"some new file"</span>))
## double check 
tsk$<span class="kw">getInputs</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="task-monitoring" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#task-monitoring" class="anchor"> </a></body></html>Task monitoring</h3>
<p>To monitor your task as it runs, you can always request a task <code>update</code> to ask your task to report its status. Or, you can monitor a running task with a hook function, which triggers the function when that status is &ldquo;completed&rdquo;. Please check the details in <a href="#hooktask">section</a> below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsk$<span class="kw">update</span>()</code></pre></div>
<p>By default, your task alerts you by email when it has been completed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Monitor your task (skip this part)
## tsk$monitor()</code></pre></div>
<p>Use the following to download all files from a completed task.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsk$<span class="kw"><a href="../reference/download.html">download</a></span>(<span class="st">"~/Downloads"</span>)</code></pre></div>
<p><a name="hooktask"></a>Instead of the default task monitor action, you can use <code>setTaskHook</code> to connect a function call to the status of a task. When you run <code>tsk$monitor(time = 30)</code> it will check your task every 30 seconds to see if the current task status matches one of the following statuses: &ldquo;queued&rdquo;, &ldquo;draft&rdquo;, &ldquo;running&rdquo;, &ldquo;completed&rdquo;, &ldquo;aborted&rdquo;, and &ldquo;failed&rdquo;. When it finds a match for the task status, <code>getTaskHook</code> returns the function call for the specific status.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/setTaskHook.html">getTaskHook</a></span>(<span class="st">"completed"</span>)</code></pre></div>
<pre><code>## function(...){
##                     cat("\r", "completed")
##                     return(TRUE)
##                 }
## &lt;environment: 0x10e58ddc0&gt;</code></pre>
<p>If you want to customize the monitor function, you can adjust the following requirement. Your function must return <code>TRUE</code> or <code>FALSE</code> in the end. When it&rsquo;s <code>TRUE</code> (or non-logical value) it means the monitoring will be terminated after it finds a status matched and the function executes, such as when the task is completed. When it&rsquo;s <code>FALSE</code> it means the monitoring will continue for the next iteration of checking, e.g.&nbsp;when it&rsquo;s &ldquo;running&rdquo;, you want to keep tracking.</p>
<p>Follow the example below to set a new function to monitor the status &ldquo;completed&rdquo;. Then, when the task is completed, it will download all task output files to local folder.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/setTaskHook.html">setTaskHook</a></span>(<span class="st">"completed"</span>, function(){
    tsk$<span class="kw"><a href="../reference/download.html">download</a></span>(<span class="st">"~/Downloads"</span>)
    <span class="kw">return</span>(<span class="ot">TRUE</span>)
})
tsk$<span class="kw">monitor</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
<p><a name="reference"></a></p>
</div>
</div>
<div id="user-friendly-api" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#user-friendly-api" class="anchor"> </a></body></html>User-friendly API</h2>
<p>The <code>sevenbridges</code> package provides a user-friendly interface so you don&rsquo;t have to combine several <code><a href="../reference/api.html">api()</a></code> calls and constantly reference the API documentation to issue API requests.</p>
<div align="right">
<a href="#top">top</a>
</div>
<div id="authentification" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#authentification" class="anchor"> </a></body></html>Authentification</h3>
<div id="set-up-a-default-token-for-different-environments" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#set-up-a-default-token-for-different-environments" class="anchor"> </a></body></html>Set up a default token for different environments</h4>
<p>You can create a file called &lsquo;.sbg.auth.yml&rsquo; in your home folder and maintain your credentials for multiple accounts across various Seven Bridges environments as follows:</p>
<pre><code>us:
  url: https://api.sbgenomics.com/v2/
  user:
    tengfei:
      token: fake_token
    yintengfei:
      token: fake_token
cgc:
  url: https://cgc-api.sbgenomics.com/
  user:
    tengfei:
      token: fake_token
gcp:
  url: https://gcp-api.sbgenomics.com/v2/
  user:
    tengfei:
      token: fake_token</code></pre>
<p>When you load the <code>sevenbridges</code> package, it first tries to parse your token configuration file into an options list, as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Create Auth object from config file
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">username =</span> <span class="st">"yintengfei"</span>, <span class="dt">platform =</span> <span class="st">"us"</span>)
## show all 
<span class="kw"><a href="../reference/Auth-class.html">getToken</a></span>()
## show all pre-set user token for platform 
<span class="kw"><a href="../reference/Auth-class.html">getToken</a></span>(<span class="st">"cgc"</span>)
## show individual token for a user
<span class="kw"><a href="../reference/Auth-class.html">getToken</a></span>(<span class="dt">platform =</span> <span class="st">"cgc"</span>, <span class="dt">username =</span> <span class="st">"tengfei"</span>)</code></pre></div>
<p><strong><em>Note:</em></strong> When you edit your <code>.sbg.auth.yml</code> file, you have to reload your <code>sevenbridges</code> package.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-auth-object-directly" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#create-auth-object-directly" class="anchor"> </a></body></html>Create Auth object directly</h4>
<p>Before you can interact with the API, you need to construct an <code>Auth</code> object which stores the following:</p>
<ul><li>Your authentication token. This is used to authenticate your credentials with the API. Learn more about obtaining your authentication token on the <a href="http://docs.sevenbridges.com/v1.0/docs/get-your-authentication-token">Seven Bridges Platform</a> and the <a href="http://docs.cancergenomicscloud.org/v1.0/docs/get-your-authentication-token">Cancer Genomics Cloud</a>.</li>
<li>The path for the API</li>
<li>The environment you&rsquo;re using (Seven Bridges Platform on AWS, Seven Bridges Platform on GCP, or the Cancer Genomics Cloud). This is an optional step, as the environment will also be specified in the API path above.</li>
</ul><p>The logic is as follows:</p>
<ol style="list-style-type: decimal"><li>If you didn&rsquo;t pass url or token, the package will assume you are loading it from the config file.</li>
<li>If no environment or user is specified, the package will use the first item in your config file. <strong>This is not recommended. Please provide an environment and username.</strong></li>
</ol><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sevenbridges)
## direct setup
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">token =</span> <span class="st">"1c0e6e202b544030870ccc147092c257"</span>,
          <span class="dt">url =</span> <span class="st">"https://cgc-api.sbgenomics.com/v2/"</span>)</code></pre></div>
<p>The above will point to the Cancer Genomics Cloud environment, unless you specify the API URL or the environment. The <code>sevenbridges</code> package currently supports specifying <code>cgc</code> for the Cancer Genomics Cloud, <code>us</code> for the Seven Bridges Platform on AWS, and <code>gcp</code> for the Seven Bridges Platform on GCP.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="list-all-api-calls" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#list-all-api-calls" class="anchor"> </a></body></html>List All API calls</h3>
<p>If you don&rsquo;t pass any parameters to <code><a href="../reference/api.html">api()</a></code> from <code>Auth</code>, it will list all API calls. Any parameters you provide will be passed to the <code><a href="../reference/api.html">api()</a></code> function, but you don&rsquo;t have to pass your input token and path once more ince the <code>Auth</code> object already has this information. The following call fromt he <code>Auth</code> object will check the response as well.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw"><a href="../reference/api.html">api</a></span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="offset-and-limit-and-search" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#offset-and-limit-and-search" class="anchor"> </a></body></html>Offset and Limit and Search</h3>
<p>Before we start, keep in mind the following:</p>
<p><strong><code>offset</code> and <code>limit</code></strong></p>
Every API call accept arguments called <code>offset</code> and <code>limit</code>.
<ul><li>
Offset defines where the retrieved items started.
</li>
<li>
Limit defines the quantity of items you want to get.
</li>
</ul><p>By default, <code>offset</code> is set to <code>0</code> and <code>limit</code> is set to <code>50</code>. As such, your API request returns the <strong>first 100 items</strong> when you list items or search for items by name. To search and list all items, use <code>complete = TRUE</code> in your API request.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getOption</span>(<span class="st">"sevenbridges"</span>)$offset
<span class="kw">getOption</span>(<span class="st">"sevenbridges"</span>)$limit</code></pre></div>
<p><strong>Search by ID</strong></p>
<p>When searching by ID, your request will return your exact resource as it is unique. As such, you don&rsquo;t have to manually set <code>offset</code> and <code>limit</code>. It&rsquo;s good practice to find your resources by their ID and pass this ID as an input to your task. You can find a resource&rsquo;s ID in the final part of the URL on the visual interface or via the API requests to list resources or get a resource&rsquo;s details.</p>
<p><strong>Search by name</strong></p>
<p>Search by name returns all partial matches unless you specify <code>exact = TRUE</code>. This type of search will only search across current pulled content, so use <code>complete = TRUE</code> if you want to search across everything.</p>
<p>For example, to list all public apps, use <code>visibility</code> argument, but make sure you pass <code>complete = TRUE</code> to it, to show every single things. This arguments generally works for items like &ldquo;App&rdquo;, &ldquo;Project&rdquo;, &ldquo;Task&rdquo;, &ldquo;File&rdquo; etc</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## first, search by id is fast
x &lt;-<span class="st"> </span>a$<span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">id =</span> <span class="st">"djordje_klisic/public-apps-by-seven-bridges/sbg-ucsc-b37-bed-converter/0"</span>)

## show 100 items from public
x &lt;-<span class="st">  </span>a$<span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>)
<span class="kw">length</span>(x) ## 100


x &lt;-<span class="st"> </span>a$<span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="kw">length</span>(x) ## 211 by March, 2016
## this return nothing, because it's not in the first 100 
a$<span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">name =</span> <span class="st">"bed converter"</span>)
## this return an app, because it pulls all apps and did serach.
a$<span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">name =</span> <span class="st">"bed converter"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="rate-limits" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#rate-limits" class="anchor"> </a></body></html>Rate Limits</h3>
<p>This call returns information about your current rate limit. This is the number of API calls you can make in one hour.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">rate_limit</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="users" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#users" class="anchor"> </a></body></html>Users</h3>
<p>This call returns a list of the resources, such as projects, billing groups, and organizations, that are accessible to you. Currently, this call will only return a successful response if {username} is replaced with your own username. Be sure to capitalize your username in the same way as when you registered for an account.</p>
<p>If you don&rsquo;t provide a username, your user information will be shown.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## return your information
a$<span class="kw">user</span>()
## return user 'tengfei''s information
a$<span class="kw">user</span>(<span class="st">"tengfei"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="billing-group-and-invoices" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#billing-group-and-invoices" class="anchor"> </a></body></html>Billing Group and Invoices</h3>
<div id="for-billing" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#for-billing" class="anchor"> </a></body></html>For billing</h4>
<p>If no billing group <code>id</code> is provided, this call returns a list of paths used to access billing information via the API. If a username is provided, this call lists all your billing groups, including groups that are pending or which have been disabled. If you specify <code>breakdown = TRUE</code>, the call below returns a breakdown of the spending per-project for the billing group specified by billing_group. Information is also displayed for each of the projects a particular billing group is associated with, including task executions, their initiating user, start and end time, and their cost.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## return a BillingList object
(b &lt;-<span class="st"> </span>a$<span class="kw">billing</span>())
a$<span class="kw">billing</span>(<span class="dt">id =</span> b$id, <span class="dt">breakdown =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="for-invoices" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#for-invoices" class="anchor"> </a></body></html>For invoices</h4>
<p>If no Billing Group <code>id</code> provided, This call returns a list of invoices, with information about each, including whether or not the invoice is pending and the billing period it covers. This call returns information about all your available invoices, unless you use the query parameter bg_id to specify the ID of a particular Billing Group, in which case it will return the invoice incurred by that Billing Group only. If an invoice <code>id</code> is provided, this call retrieves information about the specified invoice, including the costs for analysis and storage and the invoice period.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">invoice</span>()
a$<span class="kw">invoice</span>(<span class="dt">id =</span> <span class="st">"fake_id"</span>)</code></pre></div>
<p><strong><em>Note:</em></strong> Currently, invoice is not an object. Instead, it just returns a list.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="project-operation" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#project-operation" class="anchor"> </a></body></html>Project Operation</h3>
<p>Projects are the basic units to organize different entities: files, tasks, apps, etc. As such, many actions stem from the `Project&rsquo; object.</p>
<div align="right">
<a href="#top">top</a>
</div>
<div id="list-all-projects" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#list-all-projects" class="anchor"> </a></body></html>List All Projects</h4>
<p>The following call returns a list of all projects of which you are a member. Each project&rsquo;s <code>project_id</code> and path will be returned.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">project</span>()</code></pre></div>
<p>If you want to list the projects owned by and accessible to a particular user, specify the <code>owner</code> argument as follows. Each project&rsquo;s ID and path will be returned.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">project</span>(<span class="dt">owner =</span> <span class="st">"tengfei"</span>)
a$<span class="kw">project</span>(<span class="dt">owner =</span> <span class="st">"yintengfei"</span>)</code></pre></div>
<p>To get details about project(s), use <code>detail = TRUE</code>, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">project</span>(<span class="dt">detail =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="partial-match-project-name" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#partial-match-project-name" class="anchor"> </a></body></html>Partial Match Project Name</h4>
<p>For a more friendly interface and convenient search, the <code>sevenbridges</code> package supports partial name matching. The first argument for the following request is <code>name</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## want to return a project called
a$<span class="kw">project</span>(<span class="st">"hello"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-new-project" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#create-a-new-project" class="anchor"> </a></body></html>Create a New Project</h4>
<p>To create a new project, users need to specify the following:</p>
<ul><li><code>name</code> (required)</li>
<li><code>billing_group_id</code> (required)</li>
<li><code>description</code> (optional)</li>
<li><code>tags</code> (optional): This has to be a list(). If you are using the API on the CGC environment, you can create a TCGA Controlled DAta project by specifying <code>TCGA</code> in <code>tags</code>.</li>
<li><code>type</code> (optional): By default, we create a V2, CWL compatible project.</li>
</ul><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">project_new</span>(<span class="st">"api_testing_tcga"</span>, b$id,
              <span class="dt">description =</span> <span class="st">"Test for API"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-new-project-with-tcga-controlled-data-on-cgc" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#create-a-new-project-with-tcga-controlled-data-on-cgc" class="anchor"> </a></body></html>Create a new project with TCGA controlled data on CGC</h4>
<p>Follow the directions above, but pass <code>tcga</code> as a value for <code>tags</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">project_new</span>(<span class="st">"controlled_project"</span>, b$id,
              <span class="dt">description =</span> <span class="st">"Test for API"</span>, <span class="dt">tags =</span> <span class="kw">list</span>(<span class="st">"tcga"</span>))</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-a-project" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#delete-a-project" class="anchor"> </a></body></html>Delete a Project</h4>
<p>You can delete a <em>single</em> project by making the request to <code>$delete()</code>. Note that the returned object from <code>a$project()</code> sometimes returns list if you use partial matching by name. The <code>$delete()</code> request cannot operate on a list. If you want to operate on a list of object, read more about batch functions in the relevant section below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## remove it, not run
a$<span class="kw">project</span>(<span class="st">"api_testing"</span>)$<span class="kw"><a href="../reference/delete.html">delete</a></span>()
## check
## will delete all projects matcht the name
<span class="kw"><a href="../reference/delete.html">delete</a></span>(a$<span class="kw">project</span>(<span class="st">"api_testing_donnot_delete_me"</span>))</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="updateedit-a-project" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#updateedit-a-project" class="anchor"> </a></body></html>Update/Edit a Project</h4>
<p>You can update the following information about an existing project:</p>
<ul><li><code>name</code></li>
<li><code>description</code></li>
<li><code>billing_group_id</code></li>
</ul><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/helloworld"</span>)
a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/helloworld"</span>)$<span class="kw">update</span>(<span class="dt">name =</span> <span class="st">"Hello World Update"</span>, 
                                                    <span class="dt">description =</span> <span class="st">"Update description"</span>)</code></pre></div>
</div>
<div id="project-member" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#project-member" class="anchor"> </a></body></html>Project Member</h4>
<div id="list-members" class="section level5">
<h5 class="hasAnchor"><html><body><a href="#list-members" class="anchor"> </a></body></html>List members</h5>
<p>This call returns a list of the members of the specified project. For each member, the response lists:</p>
<ul><li>The member&rsquo;s username</li>
<li>The member&rsquo;s permissions in the specified project</li>
</ul><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo-project"</span>)$<span class="kw">member</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="add-a-member" class="section level5">
<h5 class="hasAnchor"><html><body><a href="#add-a-member" class="anchor"> </a></body></html>Add a member</h5>
<p>This call adds a new user to the specified project. It can only be made by a user who has admin permissions in the project.</p>
<p>Requests to add a project member must include the key <code>permissions</code>. However, if you do not include a value, the member&rsquo;s permissions will be set to <code>false</code> by default.</p>
<p>Set permission by passing the following values: <code>copy</code>, <code>write</code>, <code>execute</code>, <code>admin</code>, or <code>read</code>.</p>
<p>Note: <code>read</code> is implicit and set by default. You can not be a project member without having <code>read</code> permissions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo-project"</span>)$<span class="kw">member_add</span>(<span class="dt">username =</span> <span class="st">"yintengfei"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="update-a-member" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#update-a-member" class="anchor"> </a></body></html>Update a member</h4>
<p>This call edits a user&rsquo;s permissions in the specified project. It can only be made by a user who has admin permissions in the project.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo-project"</span>)$
<span class="st">       </span><span class="kw">member</span>(<span class="dt">username =</span> <span class="st">"yintengfei"</span>)
m$<span class="kw">update</span>(<span class="dt">copy =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>== Member ==
username : yintengfei
-- Permission --
read : TRUE
write : FALSE
copy_permission : TRUE
execute : FALSE
admin : FALSE</code></pre>
<div align="right">
<a href="#top">top</a>
</div>
<div id="delete-a-member" class="section level5">
<h5 class="hasAnchor"><html><body><a href="#delete-a-member" class="anchor"> </a></body></html>Delete a member</h5>
<p>To delete an existing member, just call the <code><a href="../reference/delete.html">delete()</a></code> action on the <code>Member</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m$<span class="kw"><a href="../reference/delete.html">delete</a></span>()
## confirm
a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo-project"</span>)$<span class="kw">member</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="list-all-files" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#list-all-files" class="anchor"> </a></body></html>List all Files</h4>
<p>To list all files belonging to a project, use the following request:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo-project"</span>)
p$<span class="kw">file</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="files-and-metadata-and-tags" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#files-and-metadata-and-tags" class="anchor"> </a></body></html>Files and Metadata and Tags</h3>
<div id="list-all-files-1" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#list-all-files-1" class="anchor"> </a></body></html>List all files</h4>
<p>A better way to list files in a project uses the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## first 100 files, default offset = 0, limit = 100
p$<span class="kw">file</span>()
## list all files
p$<span class="kw">file</span>(<span class="dt">complete =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Alternatively you can get files from the <code>Auth</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">file</span>(<span class="dt">project =</span> p$id)
a$<span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"omni"</span>, <span class="dt">project =</span> p$id, <span class="dt">detail =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-and-filter-files" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#search-and-filter-files" class="anchor"> </a></body></html>Search and filter file(s)</h4>
<div id="rule-of-thumb" class="section level5">
<h5 class="hasAnchor"><html><body><a href="#rule-of-thumb" class="anchor"> </a></body></html>Rule of thumb</h5>
<p>You can easily search by partial name, exact name, or id for many items like project, apps, files. Fortunately, we have more powerful filters for files. User could serach by metadata, tags, and original task id.</p>
<ol style="list-style-type: decimal"><li><p><strong>First rule: understand the scope</strong>: We know we have default <code>limit = 100</code> and <code>offset = 0</code> for first 100 items, unless you are using arguments <code>complete = TRUE</code>. Things are different when it comes to files. When you search with exact name (search by name with <code>exact = TRUE</code> on), metadata, or tags, it searches through ALL files. You don&rsquo;t have to specify <code>complete = TRUE</code>. Simply provide the project id or make the call from a project object as shown below.</p></li>
<li><p><strong>Second rule: understand the operation</strong>: When filtering on any resource, including the same field several times with different filtering criteria results in an implicit OR operation for that field and the different criteria.When filtering by different specified fields, an implicit AND is performed between those criteria." so which are different fields, metadata, origin.task, tags, those are different fields. <strong>Note</strong> different metadata fields are treated as different fields as well, so it will be <strong>AND</strong> operation for different metadata field.</p></li>
</ol><p>So for a quick example, this examples gives me all files in project &ldquo;tengfei/demo&rdquo; that with metadata sample_id &ldquo;Sample1&rdquo; <strong>OR</strong> &ldquo;Sample2&rdquo;, <strong>AND</strong> the library id has to be &ldquo;EXAMPLE&rdquo;, <strong>AND</strong> tags has either &ldquo;hello&rdquo; <strong>OR</strong> &ldquo;world&rdquo;.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo"</span>)
p$<span class="kw">file</span>(<span class="dt">metadata =</span> <span class="kw">list</span>(<span class="dt">sample_id =</span> <span class="st">"Sample1"</span>, 
                       <span class="dt">sample_id =</span> <span class="st">"Sample2"</span>, 
                       <span class="dt">library_id =</span> <span class="st">"EXAMPLE"</span>), 
       <span class="dt">tag =</span> <span class="kw">c</span>(<span class="st">"hello"</span>, <span class="st">"world"</span>))</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-names-and-id" class="section level5">
<h5 class="hasAnchor"><html><body><a href="#search-by-names-and-id" class="anchor"> </a></body></html>Search by names and id</h5>
<p>There are two ways to return the exact file you want. One is by <code>id</code>, the other one is by exact <code>name</code>.</p>
<p><strong><em>For advanced users:</em></strong> When searching by name with <code>exact = TRUE</code>, it directly uses our public API call to match exact name and return the object with a single query. When you turn off <code>exact</code>, it will <code>grep</code> all files or files defined with <code>limit</code> and <code>offset</code> first, then match by name, which could be slow.</p>
<p>To get the file id, you can check the url on the visual interface from the file details page.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## return single object id is "some_file_id"
p$<span class="kw">file</span>(<span class="dt">id =</span> <span class="st">"some_file_id"</span>)
## return single object named a.fastq
p$<span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"a.fastq"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
## public file search using Auth object
a$<span class="kw">public_file</span>(<span class="dt">name =</span> <span class="st">"ucsc.hg19.fasta.fai"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
a$<span class="kw">public_file</span>(<span class="dt">id =</span> <span class="st">"578cf94a507c17681a3117e8"</span>)</code></pre></div>
<p>To get more than one object, the arguments <code>id</code> and <code>name</code> both accept vectors, so you can pass more than one <code>id</code> or <code>name</code> to it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## get two files
p$<span class="kw">file</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="st">"test1.fastq"</span>, <span class="st">"test2.fastq"</span>), <span class="dt">exact =</span> <span class="ot">TRUE</span>)
## get two files from public files using shorhand
a$<span class="kw">public_file</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="st">"ucsc.hg19.fasta.fai"</span>, <span class="st">"ucsc.hg19.fasta"</span>), 
              <span class="dt">exact =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>If you don&rsquo;t use <code>exact = TRUE</code>, the API will assume it&rsquo;s pattern grep and use partial matching.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## get matchd the pattern for searching first 100 files
p$<span class="kw">file</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="st">"gz"</span>, <span class="st">"fastq"</span>))
## get all matched files from the project
p$<span class="kw">file</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="st">"gz"</span>, <span class="st">"fastq"</span>), <span class="dt">complete =</span> <span class="ot">TRUE</span>)
## get all files matched ucsc
a$<span class="kw">public_file</span>(<span class="dt">name =</span> <span class="st">"ucsc.hg19"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-metadata" class="section level5">
<h5 class="hasAnchor"><html><body><a href="#search-by-metadata" class="anchor"> </a></body></html>Search by metadata</h5>
<p>When you specify different metadata fields, the values use an <strong>AND</strong> operation, and when you specify the same metadata fields, the values use an <strong>OR</strong> operation.</p>
<p>To list all files in project &ldquo;tengfei/demo&rdquo;, that have a <code>sample_id</code> of &ldquo;Sample1&rdquo; <strong>OR</strong> &ldquo;Sample2&rdquo; <strong>AND</strong> another metadata field library_id set to &ldquo;EXAMPLE&rdquo;, make the following request</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo"</span>)
p$<span class="kw">file</span>(<span class="dt">metadata =</span> <span class="kw">list</span>(<span class="dt">sample_id =</span> <span class="st">"Sample1"</span>, 
                       <span class="dt">sample_id =</span> <span class="st">"Sample2"</span>, 
                       <span class="dt">library_id =</span> <span class="st">"EXAMPLE"</span>)) </code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-tags" class="section level5">
<h5 class="hasAnchor"><html><body><a href="#search-by-tags" class="anchor"> </a></body></html>Search by tags</h5>
<p>Tags are more flexible than metadata. You can search with multiple tags using an <strong>OR</strong> operation.</p>
<p>This examples shows how to return all files with the tag &ldquo;s1&rdquo; <strong>OR</strong> &ldquo;s2&rdquo;.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo"</span>)
p$<span class="kw">file</span>(<span class="dt">tag =</span> <span class="kw">c</span>(<span class="st">"s1"</span>, <span class="st">"s2"</span>)) </code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="search-by-original-task-id" class="section level5">
<h5 class="hasAnchor"><html><body><a href="#search-by-original-task-id" class="anchor"> </a></body></html>Search by original task id</h5>
<p>You can also get all files from a task. There are two ways to do it:</p>
<ol style="list-style-type: decimal"><li>You can started from the <code>Task</code> object.</li>
<li>You can also use the filter criteria.</li>
</ol><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## list all outputs file from a task id
a$<span class="kw">task</span>(<span class="dt">id =</span> <span class="st">"53020538-6936-422f-80de-02fa65ae4b39"</span>)$<span class="kw">file</span>()

## OR
p =<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo"</span>)
p$<span class="kw">file</span>(<span class="dt">origin.task =</span> <span class="st">"53020538-6936-422f-80de-02fa65ae4b39"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="copy-a-file-or-group-of-files" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#copy-a-file-or-group-of-files" class="anchor"> </a></body></html>Copy a file or group of files</h4>
<p>This call copies the specified file to a new project. Files retain their metadata when copied, but may be assigned new names in their target project.</p>
<p>Note that Controlled Data files may not be copied to Open Data projects. To make this request, you should have copy permission within the project you are copying from.</p>
<p>Let&rsquo;s try to copy a file from the Public File repository. The file&rsquo;s id is &ldquo;561e1b33e4b0aa6ec48167d7&rdquo;.</p>
<p>You must provide</p>
<ul><li><code>id</code>: file id or list/vector of files ids</li>
<li><code>project</code>: project id.</li>
<li><code>name</code> (optional):if omitted, use the same name as the original file name</li>
</ul><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## 1000G_omni2.5.b37.vcf
fid &lt;-<span class="st"> "561e1b33e4b0aa6ec48167d7"</span>
fid2 &lt;-<span class="st"> "561e1b33e4b0aa6ec48167d3"</span>
pid &lt;-<span class="st"> </span>a$<span class="kw">project</span>(<span class="st">"demo"</span>)$id
a$<span class="kw">copyFile</span>(<span class="kw">c</span>(fid, fid2), <span class="dt">project =</span> pid)
a$<span class="kw">project</span>(<span class="dt">id =</span> pid)$<span class="kw">file</span>()</code></pre></div>
<p><strong><em>NOTE:</em></strong> To copy a group of files, you need the <code>Auth$copyFile()</code> interface. The <code>id</code> of the files in your project will be different from their <code>id</code> in the Public Files repository.</p>
<p>Alternatively, you copy a <strong>single file</strong> as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">project</span>(<span class="st">"hello"</span>)$<span class="kw">file</span>(<span class="dt">id =</span> fid)$<span class="kw">copyTo</span>(pid)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-files" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#delete-files" class="anchor"> </a></body></html>Delete file(s)</h4>
<p><strong><em>Note:</em></strong> The <code>delete</code> action only works for one file at a time. Be sure your <code>file</code> call returns a single file rather than a file list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">file</span>()[[<span class="dv">1</span>]]$<span class="kw"><a href="../reference/delete.html">delete</a></span>()
## confirm the deletion
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">file</span>()</code></pre></div>
<p>You can also delete a group of files or <code>FilesList</code> object, <strong>be careful</strong> with this function!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## return 5 files
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">file</span>(<span class="st">"phase1"</span>)
## delete all of them
<span class="kw"><a href="../reference/delete.html">delete</a></span>(a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">file</span>(<span class="st">"phase1"</span>))
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">file</span>(<span class="st">"phase1"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="download-files" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#download-files" class="anchor"> </a></body></html>Download files</h4>
<p>To get the download information, please use the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">file</span>()[[<span class="dv">1</span>]]$<span class="kw">download_url</span>()</code></pre></div>
<p>To download directly from R, use the <code>download</code> call directly from a single <code>File</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fid &lt;-<span class="st"> </span>a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">file</span>()[[<span class="dv">1</span>]]$id
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">file</span>(<span class="dt">id =</span> fid3)$<span class="kw"><a href="../reference/download.html">download</a></span>(<span class="st">"~/Downloads/"</span>)</code></pre></div>
<p>I also created a <code>download</code> function for <code>FilesList</code> object to save your time, as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fls &lt;-<span class="st"> </span>a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">file</span>()
<span class="kw"><a href="../reference/download.html">download</a></span>(fls, <span class="st">"~/Downloads/"</span>)</code></pre></div>
<p>To download all files from a project, use the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw"><a href="../reference/download.html">download</a></span>(<span class="st">"~/Downloads"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="upload-files" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#upload-files" class="anchor"> </a></body></html>Upload files</h4>
<p>Seven Bridges environments provide a few different methods for data import, as follows:</p>
<ul><li>The command line uploader</li>
<li>A graphic visual interface uploader</li>
<li>From FTP, HTTP, etc. from the visual interface directly</li>
<li>The API uploader that you can directly call with the <code>sevenbridges</code> package</li>
</ul><p>Use the API client uploader by calling the <code>project$upload</code> function to upload a file, a file list, or a folder recursively:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">username =</span> <span class="st">"tengfei"</span>, <span class="dt">platform =</span> <span class="st">"cgc"</span>)
fl &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"sample1.fastq"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)

(p &lt;-<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/quickstart"</span>))

## by default load .meta for the file
p$<span class="kw">upload</span>(fl, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)
## pass metadata
p$<span class="kw">upload</span>(fl, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>, <span class="dt">metadata =</span> <span class="kw">list</span>(<span class="dt">library_id =</span> <span class="st">"testid2"</span>, <span class="dt">platform =</span> <span class="st">"Illumina x11"</span>))
## rename
p$<span class="kw">upload</span>(fl, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>, <span class="dt">name =</span> <span class="st">"sample_new_name.fastq"</span>, 
         <span class="dt">metadata =</span> <span class="kw">list</span>(<span class="dt">library_id =</span> <span class="st">"new_id"</span>))</code></pre></div>
<p><strong>Upload a folder</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dir.ext &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
<span class="kw">list.files</span>(dir.ext)
p$<span class="kw">upload</span>(dir.ext, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Upload a file list</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dir.ext &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
## enable full name
fls &lt;-<span class="st"> </span><span class="kw">list.files</span>(dir.ext, <span class="dt">recursive =</span> <span class="ot">TRUE</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>)
p$<span class="kw">upload</span>(fls, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)
p$<span class="kw">upload</span>(<span class="st">"~/Documents/Data/sbgtest/1000G_phase1.snps.high_confidence.b37.vcf"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="update-a-file" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#update-a-file" class="anchor"> </a></body></html>Update a file</h4>
<p>You can call the <code>update()</code> function from the Files object. Using this call, the following can be updated:</p>
<ul><li>The file&rsquo;s <code>name</code>.</li>
<li>The file&rsquo;s <code>metadata</code>. The metadata is in the form of a list. Note that as this call overwrites all the metadata for a given file, please supply a full list of all the metadata for the file. Conversely, you can use the <a href="#set_metadata"><code>set_meta()</code> function</a> to patch but not overwrite the metadata for a file.</li>
</ul><p>If no parameters are provided, this call will just get the details of that file and update the object itself.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(fl &lt;-<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo-project"</span>)$<span class="kw">file</span>(<span class="dt">name =</span> <span class="st">"sample.fastq"</span>))</code></pre></div>
<pre><code>== File ==
id : 56c7916ae4b03b56a7d7
name : sample.fastq
project : tengfei/demo-project</code></pre>
<p><strong>Show metadata</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## show metadata
fl$<span class="kw">meta</span>()</code></pre></div>
<p><strong>Update meta</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fl$<span class="kw">update</span>(<span class="dt">name =</span> <span class="st">"sample.fastq"</span>, <span class="dt">metadata =</span> <span class="kw">list</span>(<span class="dt">new_item1 =</span> <span class="st">"item1"</span>, <span class="dt">new_item2 =</span> <span class="st">"item2"</span>, <span class="dt">file_extension =</span> <span class="st">"fastq"</span>))
## check it out
fl$<span class="kw">meta</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="metadata-operations" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#metadata-operations" class="anchor"> </a></body></html>Metadata Operations</h4>
<p>Learn about metadata fields and their values for the relevant environment: [<a href="http://docs.sevenbridges.com/docs/metadata-on-the-seven-bridges-platform">Seven Bridges Platform</a>] [<a href="http://docs.cancergenomicscloud.org/v1.0/docs/metadata-for-private-data">CGC</a>]</p>
<p>Note that the name of a file is not the same as its ID. A file&rsquo;s ID is a hexadecimal string automatically assigned to a file in a project. The file&rsquo;s name is a human-readable string. For information, please see the API overview for the <a href="http://docs.sevenbridges.com/v1.0/docs/the-api">Seven Bridges Platform</a> and for the <a href="http://docs.cancergenomicscloud.org/docs/the-cgc-api">CGC</a>.</p>
<p><strong>Get metadata</strong> To get the metadata for a file, call the <code>meta()</code> function, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## meta is pulling the latest information via API
fl$<span class="kw">meta</span>()
## field meta data saved the previous saved one
fl$metadata</code></pre></div>
<p><a name="set_metadata"></a> <strong>Set metadata</strong> Files from curated datasets on Seven Bridges environments have a defined set of metadata which is visible on the visual interface of each environment. However, you can also pass additional metadata for each file which is stored with your copy of the file in your project.</p>
<p>To set metadata but not overwrite all previously stored metadata, call the <code>set_meta()</code> function from the Files object. Unlike the <code>update()</code> function for the Files object, the <code>set_meta()</code> function doesn&rsquo;t overwrite the metadata field. To overwrite the metadata field, use the <code>update()</code> function or pass the optional argument <code>overwrite = TRUE</code> for the <code>set_meta()</code> call.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fl$<span class="kw">set_meta</span>(<span class="dt">new_item3 =</span> <span class="st">"item3"</span>)
fl
## oops it removed rest of the meta
fl$<span class="kw">set_meta</span>(<span class="dt">new_item4 =</span> <span class="st">"item4"</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)
fl</code></pre></div>
<p><strong>Check details of each metadata field</strong></p>
<p>You can use the <code><a href="../reference/Metadata-class.html">Metadata()</a></code> constructor to check the details of each metadata field. Simply call the function (name of the metadata) to display descriptions and enumerated itemts. Please pay attention to the <code>suggested_values</code> field.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## check which schema we have
<span class="kw"><a href="../reference/Metadata-class.html">Metadata</a></span>()$<span class="kw">show</span>(<span class="dt">full =</span> <span class="ot">TRUE</span>)
## check details for each, play with it
<span class="kw"><a href="../reference/Metadata-class.html">platform</a></span>()
<span class="kw"><a href="../reference/Metadata-class.html">paired_end</a></span>()
<span class="kw"><a href="../reference/Metadata-class.html">quality_scale</a></span>()</code></pre></div>
<p>As you can see, some metadata fields have suggested values. To construct the metadata, use <code><a href="../reference/Metadata-class.html">Metadata()</a></code> directly to pass the metadata fields and their values directly into the call. The call will perform the validation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/Metadata-class.html">Metadata</a></span>(<span class="dt">platform  =</span> <span class="st">"Affymetrix SNP Array 6.0"</span>, 
         <span class="dt">paired_end =</span> <span class="dv">1</span>, 
         <span class="dt">quality_scale =</span> <span class="st">"sanger"</span>,
         <span class="dt">new_item =</span> <span class="st">"new test"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="tag-files" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#tag-files" class="anchor"> </a></body></html>Tag file(s)</h4>
<p>You can tag your files with keywords or strings to make it easier to identify and organize files. Tags are different from metadata, and are more convenient and visible from the files list on the visual interface.</p>
<p><strong>Add a new tag</strong></p>
<p>To add a new tag, call the <code>obj$add_tag()</code> method for the File object with a single tag string or a list or vector of tags.</p>
<p><strong>Overwrite the tags for a file</strong></p>
<p>To completely overwrite the tags for a file, use the <code>obj$set_tag()</code> method, which contains the default argument <code>overwrite = TRUE</code>.</p>
<p>Let&rsquo;s use a file called &ldquo;sample.bam&rdquo; and play with its tags.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/s3tutorial"</span>)
fl =<span class="st"> </span>p$<span class="kw">file</span>(<span class="st">"sample.bam"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
## show tags for single file
fl$<span class="kw">tag</span>()
## add new tags
fl$<span class="kw"><a href="../reference/set_tag.html">add_tag</a></span>(<span class="st">"new tag"</span>)
## equavilent to 
fl$<span class="kw"><a href="../reference/set_tag.html">set_tag</a></span>(<span class="st">"new tag 2"</span>, <span class="dt">overwrite =</span> <span class="ot">FALSE</span>)
## set tags to overwrite existing
x =<span class="st"> </span><span class="kw">list</span>(<span class="st">"this"</span>, <span class="st">"is"</span>, <span class="dv">1234</span>)
fl$<span class="kw"><a href="../reference/set_tag.html">set_tag</a></span>(x)
## filter by tags
p$<span class="kw">file</span>(<span class="dt">tag =</span> <span class="kw">c</span>(<span class="st">"1234"</span>, <span class="st">"new"</span>))
p$<span class="kw">file</span>(<span class="dt">tag =</span> <span class="kw">list</span>(<span class="st">"1234"</span>, <span class="st">"new"</span>))
p$<span class="kw">file</span>(<span class="dt">tag =</span> <span class="st">"1234"</span>)</code></pre></div>
<p>Below, find convenient methods for <code>FilesList</code>. Let&rsquo;s add the tag &ldquo;s1&rdquo; to a group files matching &ldquo;Sample1&rdquo; and add the tag &ldquo;s2&rdquo; to a group of files that match &ldquo;s2&rdquo;. Then, we&rsquo;ll filter by these tags to obtain specific files.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## work on a group of files
## add tag "s2" to a group of files named with "Sample2" in it
fl2 =<span class="st"> </span>p$<span class="kw">file</span>(<span class="st">"Sample2"</span>)
<span class="kw"><a href="../reference/set_tag.html">add_tag</a></span>(fl2, <span class="st">"s2"</span>)
## add tag "s2" to a group of files named with "Sample1" in it
fl1 =<span class="st"> </span>p$<span class="kw">file</span>(<span class="st">"Sample1"</span>)
<span class="kw"><a href="../reference/set_tag.html">add_tag</a></span>(fl1, <span class="st">"s1"</span>)
## filter by tag s1 or s2
p$<span class="kw">file</span>(<span class="dt">tag =</span> <span class="st">"s1"</span>)
p$<span class="kw">file</span>(<span class="dt">tag =</span> <span class="st">"s2"</span>)
## get files tagged with s2 and 1234
p$<span class="kw">file</span>(<span class="dt">tag =</span> <span class="kw">list</span>(<span class="st">"s2"</span>, <span class="st">"s1"</span>))</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="app" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#app" class="anchor"> </a></body></html>App</h3>
<p>All Seven Bridges environments support the <a href="http://www.commonwl.org/">Common Workflow Language (CWL)</a> natively to allow for reproducible and portable workflows and tools. In this section, we will work with apps, including tools and workflows, via the API using the R library.</p>
<div align="right">
<a href="#top">top</a>
</div>
<div id="list-all-apps" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#list-all-apps" class="anchor"> </a></body></html>List all apps</h4>
<p>This call lists all the apps available to you.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">app</span>()
## or show details
a$<span class="kw">app</span>(<span class="dt">detail =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><strong>Search for an app by name</strong></p>
<p>To search for a specific app by its name, pass a pattern for the <code>name</code> argument or provide a unique <code>id</code> as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## pattern match
a$<span class="kw">app</span>(<span class="dt">name =</span> <span class="st">"STAR"</span>)
## unique id
aid &lt;-<span class="st"> </span>a$<span class="kw">app</span>()[[<span class="dv">1</span>]]$id
aid
a$<span class="kw">app</span>(<span class="dt">id =</span> aid)
## get a specific revision from an app
a$<span class="kw">app</span>(<span class="dt">id =</span> aid, <span class="dt">revision =</span> <span class="dv">0</span>)</code></pre></div>
<p><strong>List all apps in a project</strong></p>
<p>To list all apps belonging to a specific project, use the <code>project</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## my favorite, always
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">app</span>()

## or alternatviely
pid &lt;-<span class="st"> </span>a$<span class="kw">project</span>(<span class="st">"demo"</span>)$id
a$<span class="kw">app</span>(<span class="dt">project =</span> pid)</code></pre></div>
<p><strong>List all public apps</strong></p>
<p>To list all public apps, use the <code>visibility</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## show 100 items from public
x =<span class="st"> </span>a$<span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>)
<span class="kw">length</span>(x)
x =<span class="st"> </span>a$<span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="kw">length</span>(x)
x =<span class="st"> </span>a$<span class="kw">app</span>(<span class="dt">project =</span> <span class="st">"tengfei/helloworld"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)
<span class="kw">length</span>(x)
a$<span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">limit =</span> <span class="dv">5</span>, <span class="dt">offset =</span> <span class="dv">150</span>)</code></pre></div>
<p><strong>Search through all public apps in all locations</strong></p>
<p>To search for a public app cross all locations, make the following call. Note that this may take a bit of time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">app</span>(<span class="st">"STAR"</span>, <span class="dt">visibility =</span> <span class="st">"public"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="copy-an-app" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#copy-an-app" class="anchor"> </a></body></html>Copy an App</h4>
<p>This call copies the specified app to a specified project. The app should be one in a project that you can access, either an app which has been uploaded by a project member or a publicly availble app which has been copied to the project.</p>
<p>This call requires the following two arguments:</p>
<ul><li><code>project</code>: include the project id</li>
<li><code>name</code> (optional): use this field to optionally re-name your app</li>
</ul><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">aid &lt;-<span class="st"> </span>a$<span class="kw">public_app</span>()[[<span class="dv">1</span>]]$id
a$<span class="kw">copy_app</span>(aid, <span class="dt">project =</span> pid, <span class="dt">name =</span> <span class="st">"copy-rename-test"</span>)
## check it is copied
a$<span class="kw">app</span>(<span class="dt">project =</span> pid)</code></pre></div>
<p>You can also copy directly from the app object, as shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">app =<span class="st"> </span>a$<span class="kw">public_app</span>(<span class="dt">id =</span> <span class="st">"admin/sbg-public-data/rna-seq-alignment-star"</span>)
app$<span class="kw">copy_to</span>(<span class="dt">project =</span> <span class="st">"tengfei/api-testing"</span>, 
            <span class="dt">name =</span> <span class="st">"copy of star"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-an-apps-cwl-description" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#get-an-apps-cwl-description" class="anchor"> </a></body></html>Get an app&rsquo;s CWL description</h4>
<p>This call returns the raw CWL of a specific app, including its raw CWL. The call differs from the call to GET details of an app in that it returns a JSON object that is the CWL.</p>
<p>The app should be one in a project that you can access, either an app which has been uploaded by a project member or a publicly availble app which has been copied to the project.</p>
<p>To get a specific revision, pass the <code>revision</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ap &lt;-<span class="st"> </span>a$<span class="kw">app</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>)[[<span class="dv">1</span>]]
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">app</span>(<span class="st">"index"</span>)
## get a specific revision
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">app</span>(<span class="st">"index"</span>, <span class="dt">revision =</span> <span class="dv">0</span>)</code></pre></div>
<p>Coming soon: converting apps to CWL objects</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="add-cwl-as-an-app" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#add-cwl-as-an-app" class="anchor"> </a></body></html>Add CWL as an APP</h4>
<p>To add a CWL object as an app, use the <code>app_add</code> function call for a <code>Project</code> object. The following two parameters are required:</p>
<ul><li><code>short_name</code>: Project short names are based on the name you give to a project when you create it. Learn more about project short names on the <a href="http://docs.sevenbridges.com/v1.0/docs/the-api#section-project-short-names">Seven Bridges Platform</a> or the <a href="http://docs.cancergenomicscloud.org/v1.0/docs/the-cgc-api#section-project-short-names">CGC</a>.</li>
<li><code>filename</code>: The name of the JSON file containing the CWL.</li>
</ul><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cwl.fl &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"bam_index.json"</span>, <span class="dt">package =</span> <span class="st">"sevenbridges"</span>)
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">app_add</span>(<span class="dt">short_name =</span> <span class="st">"new_bam_index_app"</span>, <span class="dt">filename =</span> cwl.fl)
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">app_add</span>(<span class="dt">short_name =</span> <span class="st">"new_bam_index_app"</span>, <span class="dt">revision =</span> <span class="dv">2</span>, <span class="dt">filename =</span> cwl.fl)</code></pre></div>
<p>Note: If you provide the same <code>short_name</code>, this will add a new revision.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="directly-describe-cwl-in-r" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#directly-describe-cwl-in-r" class="anchor"> </a></body></html>Directly Describe CWL in R</h4>
<p>This is introduced in another vignette.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="task-operation" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#task-operation" class="anchor"> </a></body></html>Task Operation</h3>
<div id="list-tasks" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#list-tasks" class="anchor"> </a></body></html>List tasks</h4>
<p>This call returns a list of tasks that you can access. You are able to filter tasks by status.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## all tasks
a$<span class="kw">task</span>()
## filter
a$<span class="kw">task</span>(<span class="dt">status =</span> <span class="st">"completed"</span>)
a$<span class="kw">task</span>(<span class="dt">status =</span> <span class="st">"running"</span>)</code></pre></div>
<p>To list all tasks in a project, use the following.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## better way
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">task</span>()

## alternatively
pid &lt;-<span class="st"> </span>a$<span class="kw">project</span>(<span class="st">"demo"</span>)$id
a$<span class="kw">task</span>(<span class="dt">project =</span> pid)</code></pre></div>
<p>To list all tasks with details, pass <code>detail = TRUE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p$<span class="kw">task</span>(<span class="dt">id =</span> <span class="st">"your task id here"</span>, <span class="dt">detail =</span> <span class="ot">TRUE</span>)
p$<span class="kw">task</span>(<span class="dt">detail =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>To list a batch task using the <code>parent</code> parameter, pass the batch parent task id.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p =<span class="st"> </span>a$<span class="kw">project</span>(<span class="dt">id =</span> <span class="st">"tengfei/demo"</span>)
p$<span class="kw">task</span>(<span class="dt">id =</span> <span class="st">"2e1ebed1-c53e-4373-870d-4732acacbbbb"</span>)
p$<span class="kw">task</span>(<span class="dt">parent =</span> <span class="st">"2e1ebed1-c53e-4373-870d-4732acacbbbb"</span>)
p$<span class="kw">task</span>(<span class="dt">parent =</span> <span class="st">"2e1ebed1-c53e-4373-870d-4732acacbbbb"</span>, <span class="dt">status =</span> <span class="st">"completed"</span>)
p$<span class="kw">task</span>(<span class="dt">parent =</span> <span class="st">"2e1ebed1-c53e-4373-870d-4732acacbbbb"</span>, <span class="dt">status =</span> <span class="st">"draft"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="create-a-draft-task" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#create-a-draft-task" class="anchor"> </a></body></html>Create a draft task</h4>
<p>To create a draft task, you need to call the <code>task_add</code> function from the Project object. And you need to pass the following arguments:</p>
<ul><li><code>name</code>: The name for this task</li>
<li><code>description</code> (optional): A description for this task</li>
<li><code>app</code>: The app id</li>
<li><code>inputs</code>: A list of inputs for this task</li>
</ul><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## push an app first
fl.runif &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata"</span>, <span class="st">"runif.json"</span>, <span class="dt">package =</span> <span class="st">"sbgr"</span>)
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">app_add</span>(<span class="st">"runif_draft"</span>, fl.runif)
runif_id &lt;-<span class="st"> "tengfei/demo-project/runif_draft"</span>
## create a draft task
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">task_add</span>(<span class="dt">name =</span> <span class="st">"Draft runif 3"</span>, 
                           <span class="dt">description =</span> <span class="st">"Description for runif 3"</span>, 
                           <span class="dt">app =</span> runif_id,
                           <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">10</span>))
## confirm
a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">task</span>(<span class="dt">status =</span> <span class="st">"draft"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="modify-a-task" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#modify-a-task" class="anchor"> </a></body></html>Modify a task</h4>
<p>Call the <code>update</code> function from a Task object to update the following:</p>
<ul><li><code>name</code></li>
<li><code>description</code></li>
<li><code>inputs</code> list. Note that you can only update the items you provided.</li>
</ul><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## get the single task you want to update
tsk &lt;-<span class="st"> </span>a$<span class="kw">project</span>(<span class="st">"demo"</span>)$<span class="kw">task</span>(<span class="st">"Draft runif 3"</span>)
tsk
tsk$<span class="kw">update</span>(<span class="dt">name =</span> <span class="st">"Draft runif update"</span>, <span class="dt">description =</span> <span class="st">"draft 2"</span>, 
           <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">max =</span> <span class="dv">100</span>))
## alternative way to check all inputs
tsk$<span class="kw">getInputs</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="run-a-task-1" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#run-a-task-1" class="anchor"> </a></body></html>Run a task</h4>
<p>This call runs (&ldquo;executes&rdquo;) the specified task. Only tasks with a &ldquo;DRAFT&rdquo; status may be run.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsk$<span class="kw">run</span>()
## run update without information just return latest information
tsk$<span class="kw">update</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
<p><a name="hook"></a> #### Monitor a running task and set the hook function</p>
<p>To monitor a running task, call <code>monitor</code> from a Task object.</p>
<ul><li>First argument, set the interval time to check the status</li>
<li>Rest arguments might be used for hook function</li>
</ul><div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsk$<span class="kw">monitor</span>()</code></pre></div>
<p>Get and set default a hook function for task status. Currently, failed tasks will break the monitoring.</p>
<p>Note: Hook function has to return <code>TRUE</code> (break monitoring) or <code>FALSE</code> (continuing) in the end.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/setTaskHook.html">getTaskHook</a></span>(<span class="st">"completed"</span>)
<span class="kw"><a href="../reference/setTaskHook.html">getTaskHook</a></span>(<span class="st">"draft"</span>)
<span class="kw"><a href="../reference/setTaskHook.html">setTaskHook</a></span>(<span class="st">"draft"</span>, function(){<span class="kw">message</span>(<span class="st">"never happens"</span>); <span class="kw">return</span>(<span class="ot">TRUE</span>)})
<span class="kw"><a href="../reference/setTaskHook.html">getTaskHook</a></span>(<span class="st">"draft"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="abort-a-running-task" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#abort-a-running-task" class="anchor"> </a></body></html>Abort a running task</h4>
<p>This call aborts the specified task. Only tasks whose status is &ldquo;RUNNING&rdquo; may be aborted.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## abort
tsk$<span class="kw">abort</span>()
## check
tsk$<span class="kw">update</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-a-task" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#delete-a-task" class="anchor"> </a></body></html>Delete a task</h4>
<p>Note that you can only delete DRAFT tasks, not running tasks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsklst &lt;-<span class="st"> </span>a$<span class="kw">task</span>(<span class="dt">status =</span> <span class="st">"draft"</span>)
## delete a single task
tsklst[[<span class="dv">1</span>]]$<span class="kw"><a href="../reference/delete.html">delete</a></span>()
## confirm
a$<span class="kw">task</span>(<span class="dt">status =</span> <span class="st">"draft"</span>)
## delete a list of tasks
<span class="kw"><a href="../reference/delete.html">delete</a></span>(tsklst)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="download-all-files-from-a-completed-task" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#download-all-files-from-a-completed-task" class="anchor"> </a></body></html>Download all files from a completed task</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tsk$<span class="kw"><a href="../reference/download.html">download</a></span>(<span class="st">"~/Downloads"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="run-task-in-batch-mode" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#run-task-in-batch-mode" class="anchor"> </a></body></html>Run task in batch mode</h4>
<p>To run task in batch mode, (check <code><a href="../reference/batch.html">?batch</a></code>) for more details. The code below is a mock.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## batch by items
(tsk &lt;-<span class="st"> </span>p$<span class="kw">task_add</span>(<span class="dt">name =</span> <span class="st">"RNA DE report new batch 2"</span>, 
                   <span class="dt">description =</span> <span class="st">"RNA DE analysis report"</span>, 
                   <span class="dt">app =</span> rna.app$id,
                   <span class="dt">batch =</span> <span class="kw"><a href="../reference/batch.html">batch</a></span>(<span class="dt">input =</span> <span class="st">"bamfiles"</span>),
                   <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">bamfiles =</span> bamfiles.in, 
                                 <span class="dt">design =</span> design.in,
                                 <span class="dt">gtffile =</span> gtf.in)))

## batch by metadata, input files has to have metadata fields specified
(tsk &lt;-<span class="st"> </span>p$<span class="kw">task_add</span>(<span class="dt">name =</span> <span class="st">"RNA DE report new batch 3"</span>, 
                   <span class="dt">description =</span> <span class="st">"RNA DE analysis report"</span>, 
                   <span class="dt">app =</span> rna.app$id,
                   <span class="dt">batch =</span> <span class="kw"><a href="../reference/batch.html">batch</a></span>(<span class="dt">input =</span> <span class="st">"fastq"</span>, 
                                 <span class="kw">c</span>(<span class="st">"metadata.sample_id"</span>, <span class="st">"metadata.library_id"</span>)),
                   <span class="dt">inputs =</span> <span class="kw">list</span>(<span class="dt">bamfiles =</span> bamfiles.in, 
                                 <span class="dt">design =</span> design.in,
                                 <span class="dt">gtffile =</span> gtf.in)))</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="volumes" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#volumes" class="anchor"> </a></body></html>Volumes</h3>
<p>Cloud storage providers come with their own interfaces, features and terminology. At a certain level, though, they all view resources as data objects organized in repositories. Authentication and operations are commonly defined on those objects and repositories, and while each cloud provider might call these things different names and apply different parameters to them, their basic behavior is the same.</p>
<p>Seven Bridges environments mediate access to these repositories using volumes. A volume is associated with a particular cloud storage repository that you have enabled Seven Bridges to read from (and, optionally, to write to). Currently, volumes may be created using two types of cloud storage repository: Amazon Web Services&rsquo; (AWS) S3 buckets and Google Cloud Storage (GCS) buckets.</p>
<p>A volume enables you to treat the cloud repository associated with it as external storage. You can &lsquo;import&rsquo; files from the volume to your Seven Bridges environment to use them as inputs for computation. Similarly, you can write files from the Seven Bridges environment to your cloud storage by &lsquo;exporting&rsquo; them to your volume.</p>
<p>Learn more about volumes on the <a href="http://docs.sevenbridges.com/docs/connecting-cloud-storage-overview">Seven Bridges Platform</a> and the <a href="http://docs.cancergenomicscloud.org/docs/connect-cloud-storage-overview">CGC</a>.</p>
<div id="create-a-volume" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#create-a-volume" class="anchor"> </a></body></html>Create a volume</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a =<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">user =</span> <span class="st">"tengfei"</span>, <span class="dt">platform =</span> <span class="st">"us"</span>)
a$<span class="kw">add_volume</span>(<span class="dt">name =</span> <span class="st">"tutorial_volume"</span>, 
             <span class="dt">type =</span> <span class="st">"s3"</span>, 
             <span class="dt">bucket =</span> <span class="st">"tengfei-demo"</span>, 
             <span class="dt">prefix =</span> <span class="st">""</span>,
             <span class="dt">access_key_id =</span> <span class="st">"AKIAJQENSIA4DJQNZO3A"</span>,
             <span class="dt">secret_access_key =</span> <span class="st">"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"</span>, 
             <span class="dt">sse_algorithm =</span> <span class="st">"AES256"</span>, 
             <span class="dt">access_mode =</span> <span class="st">"RW"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="list-and-search-all-volumes" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#list-and-search-all-volumes" class="anchor"> </a></body></html>List and search all volumes</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## list all volume
a$<span class="kw">volume</span>()
## get unique volume by id
a$<span class="kw">volume</span>(<span class="dt">id =</span> <span class="st">"tengfei/tengfei_demo"</span>)
## partial search by name
a$<span class="kw">volume</span>(<span class="dt">name =</span> <span class="st">"demo"</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="get-a-volumes-detail" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#get-a-volumes-detail" class="anchor"> </a></body></html>Get a volume&rsquo;s detail</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v =<span class="st"> </span>a$<span class="kw">volume</span>()
v[[<span class="dv">1</span>]]$<span class="kw">detail</span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="delete-volume" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#delete-volume" class="anchor"> </a></body></html>Delete volume</h4>
<p>This call deletes a volume you&rsquo;ve created to refer to storage on Amazon Web Services or Google Cloud Storage.</p>
<p>Note that any files you&rsquo;ve imported from your volume onto a Seven Bridges environment, known as an alias, will no longer be usable. If a new volume is created with the same volume_id as the deleted volume, aliases will point to files on the newly created volume instead (if those exist).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a$<span class="kw">volume</span>(<span class="dt">id =</span> <span class="st">"tengfei/tengfei_demo"</span>)$<span class="kw"><a href="../reference/delete.html">delete</a></span>()</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="import-file-from-volume-to-project" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#import-file-from-volume-to-project" class="anchor"> </a></body></html>Import file from volume to project</h4>
<p>This call imports a file from volume to your project.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v =<span class="st"> </span>a$<span class="kw">volume</span>(<span class="dt">id =</span> <span class="st">"tengfei/tutorial_volume"</span>)
res =<span class="st"> </span>v$<span class="kw">import</span>(<span class="dt">location =</span>  <span class="st">"A-RNA-File.bam.bai"</span>,
         <span class="dt">project =</span> <span class="st">"tengfei/s3tutorial"</span>,
         <span class="dt">name =</span> <span class="st">"new.bam.bai"</span>, 
         <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)

## get job status update
## state will be "COMPLETED" when it's finished other wise "P<span class="re">END</span>ING"
v$<span class="kw">get_import_job</span>(res$id)
v</code></pre></div>
</div>
<div id="export-file-from-project-to-volume" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#export-file-from-project-to-volume" class="anchor"> </a></body></html>Export file from project to volume</h4>
<p><strong>Important</strong> :</p>
<ul><li>The file selected for export must not be a public file or an alias. Aliases are objects stored in your cloud storage bucket which have been made available on a Seven Bridges environment. The volume you are exporting to must be configured for read-write access. To do this, set the access_mode parameter to RW when creating or modifying a volume.</li>
<li>If this call is successful, the original project file will become an alias to the newly exported object on the volume. The source file will be deleted from the Seven Bridges environment and, if no more copies of this file exist, it will no longer count towards your total storage price on the Seven Bridges environment.</li>
</ul><p>When testing please update your file in a project.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res =<span class="st"> </span>v$<span class="kw">export</span>(<span class="dt">file =</span> <span class="st">"579fb1c9e4b08370afe7903a"</span>, 
         <span class="dt">volume =</span> <span class="st">"tengfei/tutorial_volume"</span>,
         <span class="dt">location =</span> <span class="st">""</span>, ## when "" use old name
         <span class="dt">sse_algorithm =</span>  <span class="st">"AES256"</span>)
## get job status update
## state will be "COMPLETED" when it's finished other wise "P<span class="re">END</span>ING"
v$<span class="kw">get_export_job</span>(res$id)
v</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="public-files-and-apps" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#public-files-and-apps" class="anchor"> </a></body></html>Public Files and Apps</h3>
<p>Seven Bridges hosts publicly accessible files and apps on its environments. The <code>sevenbridges</code> package provides two easy function calls from the Authentication object to search for and copy files and apps to a project.</p>
<div id="public-files" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#public-files" class="anchor"> </a></body></html>Public files</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## list first 100 files 
a$<span class="kw">public_file</span>()
## list by offset and limit
a$<span class="kw">public_file</span>(<span class="dt">offset =</span> <span class="dv">100</span>, <span class="dt">limit =</span> <span class="dv">100</span>)
## simply list everything!
a$<span class="kw">public_file</span>(<span class="dt">complete =</span> <span class="ot">TRUE</span>)
## get exact file by id
a$<span class="kw">public_file</span>(<span class="dt">id =</span> <span class="st">"5772b6f0507c175267448700"</span>)
## get exact file by name with exact = TRUE
a$<span class="kw">public_file</span>(<span class="dt">name =</span> <span class="st">"G20479.HCC1143.2.converted.pe_1_1Mreads.fastq"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>)
## with exact = FALSE by default search by name pattern
a$<span class="kw">public_file</span>(<span class="dt">name =</span> <span class="st">"fastq"</span>) 
a$<span class="kw">public_file</span>(<span class="dt">name =</span> <span class="st">"G20479.HCC1143.2.converted.pe_1_1Mreads.fastq"</span>)</code></pre></div>
<p>Public files are hosted in the project called <code>admin/sbg-public-data</code>, and you can alternatively use the <code>file</code> request to get files you need.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="public-apps" class="section level4">
<h4 class="hasAnchor"><html><body><a href="#public-apps" class="anchor"> </a></body></html>Public apps</h4>
<p>For public apps, there are similar API calls.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## list for 100 apps
a$<span class="kw">public_app</span>()
## list by offset and limit
a$<span class="kw">public_app</span>(<span class="dt">offset =</span> <span class="dv">100</span>, <span class="dt">limit =</span> <span class="dv">50</span>)
## search by id
a$<span class="kw">public_app</span>(<span class="dt">id =</span> <span class="st">"admin/sbg-public-data/control-freec-8-1/12"</span>)
## search by name in ALL apps
a$<span class="kw">public_app</span>(<span class="dt">name =</span> <span class="st">"STAR"</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)
## search by name with exact match
a$<span class="kw">public_app</span>(<span class="dt">name =</span> <span class="st">"Control-FREEC"</span>, <span class="dt">exact =</span> <span class="ot">TRUE</span>, <span class="dt">complete =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="get-raw-response-from-httr" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#get-raw-response-from-httr" class="anchor"> </a></body></html>Get Raw Response from httr</h3>
<p>In the easy API, we return an object which contains the raw response from <code>httr</code> as a field. You can either call <code><a href="../reference/response.html">response()</a></code> on that object or just use the field as is.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
<div id="batch-operation-on-projectfilestasks" class="section level3">
<h3 class="hasAnchor"><html><body><a href="#batch-operation-on-projectfilestasks" class="anchor"> </a></body></html>Batch operation on project/files/tasks</h3>
<p>Currently, users have to use <code>lapply</code> to do those operations themselves. It&rsquo;s a simple implementation.</p>
<p>In this package, we implement <code>delete</code> and <code>download</code> for some objects like task, project, or file.</p>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
<div id="cheatsheet" class="section level2">
<h2 class="hasAnchor"><html><body><a href="#cheatsheet" class="anchor"> </a></body></html>Cheatsheet</h2>
<p>Quick cheat sheet (in progress)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Authentification
<span class="kw"><a href="../reference/Auth-class.html">getToken</a></span>()
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">token =</span> token)
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">token =</span> token, 
          <span class="dt">url =</span> <span class="st">"https://cgc-api.sbgenomics.com/v2/"</span>)
a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Auth-class.html">Auth</a></span>(<span class="dt">platform =</span> <span class="st">"us"</span>, <span class="dt">username =</span> <span class="st">"tengfei"</span>)

## list API
a$<span class="kw"><a href="../reference/api.html">api</a></span>()

## Rate limits
a$<span class="kw">rate_limit</span>()

## Users
a$<span class="kw">user</span>()
a$<span class="kw">user</span>(<span class="st">"tengfei"</span>)

## billing
a$<span class="kw">billing</span>()
a$<span class="kw">billing</span>(<span class="dt">id =</span> , <span class="dt">breakdown =</span> <span class="ot">TRUE</span>)
a$<span class="kw">invoice</span>()
a$<span class="kw">invoice</span>(<span class="dt">id =</span> <span class="st">"fake_id"</span>)

## Project
### create new project
a$<span class="kw">project_new</span>(<span class="dt">name =</span> , <span class="dt">billing_group_id =</span> , <span class="dt">description =</span> )
### list all project owned by you
a$<span class="kw">project</span>()
a$<span class="kw">project</span>(<span class="dt">owner =</span> <span class="st">"yintengfei"</span>)
### partial match
p &lt;-<span class="st">  </span>a$<span class="kw">project</span>(<span class="dt">name =</span> , <span class="dt">id =</span> , <span class="dt">exact =</span> <span class="ot">TRUE</span>)
### delete
p$<span class="kw"><a href="../reference/delete.html">delete</a></span>()
### update
p$<span class="kw">update</span>(<span class="dt">name =</span> , <span class="dt">description =</span> )
### members
p$<span class="kw">member</span>()
p$<span class="kw">member_add</span>(<span class="dt">username =</span> )
p$<span class="kw">member</span>(<span class="dt">username =</span> )$<span class="kw">update</span>(<span class="dt">write =</span> , <span class="dt">copy =</span> , <span class="dt">execute =</span> )
p$<span class="kw">memeber</span>(<span class="dt">usrname =</span> )$<span class="kw"><a href="../reference/delete.html">delete</a></span>()

## file
### list all files in this project
p$<span class="kw">file</span>()
### list all public files
a$<span class="kw">file</span>(<span class="dt">visibility =</span> <span class="st">"public"</span>)
### copy
a$<span class="kw">copyFile</span>(<span class="kw">c</span>(fid, fid2), <span class="dt">project =</span> pid)
### delete
p$<span class="kw">file</span>(<span class="dt">id =</span> fid)$<span class="kw"><a href="../reference/delete.html">delete</a></span>()
### download
p$<span class="kw">file</span>()[[<span class="dv">1</span>]]$<span class="kw">download_url</span>()
p$<span class="kw">file</span>(<span class="dt">id =</span> fid3)$<span class="kw"><a href="../reference/download.html">download</a></span>(<span class="st">"~/Downloads/"</span>)
### download all
<span class="kw"><a href="../reference/download.html">download</a></span>(p$<span class="kw">file</span>())
### update a file
fl$<span class="kw">update</span>(<span class="dt">name =</span> , <span class="dt">metadata =</span> <span class="kw">list</span>(<span class="dt">a =</span>  ,<span class="dt">b =</span> , ...))
### meta
fl$<span class="kw">meta</span>()
fl$<span class="kw">setMeta</span>()
fl$<span class="kw">setMeta</span>(..., <span class="dt">overwrite =</span> <span class="ot">TRUE</span>)

## App
a$<span class="kw">app</span>()
### apps in a project
p$<span class="kw">app</span>()
p$<span class="kw">app</span>(name, id, <span class="dt">revision =</span> )
a$<span class="kw">copyApp</span>(aid, <span class="dt">project =</span> pid, <span class="dt">name =</span> )
### add
p$<span class="kw">app_add</span>(<span class="dt">short_name =</span> , <span class="dt">filename =</span>)

## Task
a$<span class="kw">task</span>()
a$<span class="kw">task</span>(<span class="dt">name =</span> , <span class="dt">id =</span> )
a$<span class="kw">task</span>(<span class="dt">status =</span> )

p$<span class="kw">task</span>()
p$<span class="kw">task</span>(<span class="dt">name =</span> , <span class="dt">id =</span> )
p$<span class="kw">task</span>(<span class="dt">status =</span> )

tsk &lt;-<span class="st"> </span>p$<span class="kw">task</span>(<span class="dt">name =</span> , <span class="dt">id =</span> )
tsk$<span class="kw">update</span>()
tsk$<span class="kw">abort</span>()
tsk$<span class="kw">run</span>()
tsk$<span class="kw"><a href="../reference/download.html">download</a></span>()
tsk$<span class="kw">detele</span>()
tsk$<span class="kw">getInputs</span>()
tsk$<span class="kw">monitor</span>()

<span class="kw"><a href="../reference/setTaskHook.html">getTaskHook</a></span>()
<span class="kw"><a href="../reference/setTaskHook.html">setTaskHook</a></span>(<span class="dt">statis =</span> , <span class="dt">fun  =</span>)</code></pre></div>
<div align="right">
<a href="#top">top</a>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#introduction">Introduction</a></li>
      <li><a href="#quickstart">Quickstart</a></li>
      <li><a href="#user-friendly-api">User-friendly API</a></li>
      <li><a href="#cheatsheet">Cheatsheet</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nan Xiao, Dusan Randjelovic, Tengfei Yin, Seven Bridges Genomics.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
